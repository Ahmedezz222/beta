<main class="blog-page" role="main">
  <div class="container">
    <header class="blog-header">
      <h1>{{ blog.title }}</h1>
      {% if blog.description != blank %}
        <div class="blog-description">
          {{ blog.description }}
        </div>
      {% endif %}
    </header>

    <div class="blog-content">
      <aside class="blog-sidebar">
        <div class="sidebar-section">
          <h3>Categories</h3>
          <ul class="category-list">
            <li class="category-item">
              <a href="{{ blog.url }}" class="category-link {% unless current_tags %}active{% endunless %}">
                All Posts
              </a>
            </li>
            {% for tag in blog.all_tags %}
              <li class="category-item">
                <a href="{{ blog.url }}/tagged/{{ tag | handle }}" class="category-link {% if current_tags contains tag %}active{% endif %}">
                  {{ tag }}
                </a>
              </li>
            {% endfor %}
          </ul>
        </div>

        <div class="sidebar-section">
          <h3>Recent Posts</h3>
          <div class="recent-posts">
            {% for article in blog.articles limit:3 %}
              <div class="recent-post">
                {% if article.image %}
                  <div class="recent-post-image">
                    <a href="{{ article.url }}">
                      <img src="{{ article.image | img_url: 'small' }}" alt="{{ article.title }}" loading="lazy">
                    </a>
                  </div>
                {% endif %}
                <div class="recent-post-content">
                  <h4><a href="{{ article.url }}">{{ article.title }}</a></h4>
                  <p class="post-date">{{ article.published_at | date: '%B %d, %Y' }}</p>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>

        <div class="sidebar-section">
          <h3>Newsletter</h3>
          <p>Stay updated with cycling tips, product reviews, and exclusive offers.</p>
          <form action="/contact" method="post" class="newsletter-form">
            <div class="form-group">
              <input type="email" name="contact[email]" placeholder="Enter your email" required class="newsletter-input">
            </div>
            <button type="submit" class="btn btn-primary">Subscribe</button>
          </form>
        </div>
      </aside>

      <div class="blog-main">
        {% if blog.articles.size > 0 %}
          <div class="articles-grid">
            {% for article in blog.articles %}
              <article class="article-card">
                <div class="article-image">
                  <a href="{{ article.url }}">
                    {% if article.image %}
                      <img src="{{ article.image | img_url: 'medium' }}" alt="{{ article.title }}" loading="lazy">
                    {% else %}
                      <div class="placeholder-image">üìù</div>
                    {% endif %}
                  </a>
                  {% if article.tags.size > 0 %}
                    <div class="article-tags">
                      {% for tag in article.tags limit:2 %}
                        <span class="tag">{{ tag }}</span>
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
                
                <div class="article-content">
                  <header class="article-header">
                    <h2 class="article-title">
                      <a href="{{ article.url }}">{{ article.title }}</a>
                    </h2>
                    
                    <div class="article-meta">
                      <span class="article-date">{{ article.published_at | date: '%B %d, %Y' }}</span>
                      {% if article.author %}
                        <span class="article-author">by {{ article.author }}</span>
                      {% endif %}
                      <span class="article-comments">
                        {% if article.comments_count > 0 %}
                          {{ article.comments_count }} comments
                        {% else %}
                          No comments yet
                        {% endif %}
                      </span>
                    </div>
                  </header>
                  
                  <div class="article-excerpt">
                    {% if article.excerpt != blank %}
                      {{ article.excerpt }}
                    {% else %}
                      {{ article.content | strip_html | truncate: 150 }}
                    {% endif %}
                  </div>
                  
                  <div class="article-footer">
                    <a href="{{ article.url }}" class="read-more-link">
                      Read More
                      <span class="arrow">‚Üí</span>
                    </a>
                    
                    <div class="article-stats">
                      <span class="reading-time">5 min read</span>
                    </div>
                  </div>
                </div>
              </article>
            {% endfor %}
          </div>
          
          {% if paginate.pages > 1 %}
            <div class="blog-pagination">
              {% if paginate.previous %}
                <a href="{{ paginate.previous.url }}" class="pagination-link prev" aria-label="Previous page">
                  <span>‚Üê Previous</span>
                </a>
              {% endif %}
              
              <div class="pagination-numbers">
                {% for part in paginate.parts %}
                  {% if part.is_link %}
                    <a href="{{ part.url }}" class="pagination-link">{{ part.title }}</a>
                  {% else %}
                    <span class="pagination-current">{{ part.title }}</span>
                  {% endif %}
                {% endfor %}
              </div>
              
              {% if paginate.next %}
                <a href="{{ paginate.next.url }}" class="pagination-link next" aria-label="Next page">
                  <span>Next ‚Üí</span>
                </a>
              {% endif %}
            </div>
          {% endif %}
          
        {% else %}
          <div class="empty-blog">
            <div class="empty-icon">üìù</div>
            <h2>No articles yet</h2>
            <p>Check back soon for cycling tips, product reviews, and community stories.</p>
            <a href="/collections/all" class="btn btn-primary">Browse Products</a>
          </div>
        {% endif %}
      </div>
    </div>

    <div class="blog-featured">
      <h2>Featured Articles</h2>
      <div class="featured-articles">
        <div class="featured-article">
          <div class="featured-image">
            <img src="{{ 'bike_yard_m.jpg' | asset_url }}" alt="Cycling Tips" loading="lazy">
          </div>
          <div class="featured-content">
            <h3>Essential Cycling Safety Tips</h3>
            <p>Stay safe on the road with these important cycling safety guidelines.</p>
            <a href="#" class="btn btn-outline">Read Article</a>
          </div>
        </div>
        
        <div class="featured-article">
          <div class="featured-image">
            <img src="{{ 'bike_yard_m.jpg' | asset_url }}" alt="Bike Maintenance" loading="lazy">
          </div>
          <div class="featured-content">
            <h3>Basic Bike Maintenance Guide</h3>
            <p>Learn how to keep your bike in top condition with regular maintenance.</p>
            <a href="#" class="btn btn-outline">Read Article</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<script>
  // Blog page functionality
  document.addEventListener('DOMContentLoaded', function() {
    // Category highlighting
    const categoryLinks = document.querySelectorAll('.category-link');
    categoryLinks.forEach(link => {
      if (link.classList.contains('active')) {
        link.closest('.category-item').classList.add('active');
      }
    });
    
    // Newsletter form functionality
    const newsletterForm = document.querySelector('.newsletter-form');
    if (newsletterForm) {
      newsletterForm.addEventListener('submit', function(e) {
        const email = this.querySelector('input[type="email"]').value;
        if (!email) {
          e.preventDefault();
          alert('Please enter your email address');
        }
      });
    }
    
    // Article card hover effects
    const articleCards = document.querySelectorAll('.article-card');
    articleCards.forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-2px)';
      });
      
      card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
      });
    });
    
    // Reading time calculation (example)
    const articleExcerpts = document.querySelectorAll('.article-excerpt');
    articleExcerpts.forEach(excerpt => {
      const wordCount = excerpt.textContent.split(' ').length;
      const readingTime = Math.ceil(wordCount / 200); // Average reading speed
      
      const statsElement = excerpt.closest('.article-card').querySelector('.reading-time');
      if (statsElement) {
        statsElement.textContent = `${readingTime} min read`;
      }
    });
  });
</script>
